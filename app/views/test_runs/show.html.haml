- content_for  :title do
  Project - #{@project.name} - #{@scenario.name} - #{@test_run.number}
- content_for :head do
  =javascript_include_tag "step_status"
  :javascript
    channels = []
    window.channels = channels
    #{
      @test_run.browser_tests.map { |test| "window.channels.push(window.pusher.subscribe('#{test.channel_name}'));"}.join(' ')
    }
    window.sec = #{@test_run.duration}
    window.completed = #{!@test_run.completed_at.nil?}

= render 'projects/projects_header'

.row
  .col-md-12
    .awidget
      .awidget-head
        %h3 Test Run #{@test_run.timestamp}
      .awidget-body
        %table.test_run_header{style: "width: 100%; font-size: 1.2em"}
          %tr
            %th{style: "width: 100px;"} Started By:
            %td
              = gravatar_image_tag(@test_run.user, 16)
              = @test_run.user.name
            %th{style: "width: 100px;"} Ran:
            %td #{distance_of_time_in_words_to_now(@test_run.created_at)} ago
          %tr#tour-test-run-status
            %th#tour-if-failed{style: "width: 100px;"} Status:
            %td
              = test_run_status(@test_run)
        %br
        %br

        - @test_run.browser_tests.each_with_index do |test, index|
          / - if test.status != nil
          / .test{class: "#{test.status}"}
          /   = render partial: 'test_history', locals: {test: test}
          / - else
          .test
            = render partial: 'test', locals: {test: test, id: "#{index == 0 ? 'tour-test-run-page' : ''}"}


%ol.joyride-tour#test-run-tour
  %li{data: {id: "tour-test-run-page", button: "Next"}}
    %h3 Ta da!
  %li{data: {id: "tour-test-run-status", button: "Next"}}
    %h3 The Results
  %li{data: {id: "tour-recent-updates", button: "Next"}}
    %h3 Do I have to watch every time?
    %p You're here to save time, and time you will save! Once you hit run these tests are good to go. Once they're done, you'll get an update (as well as an email if you have that setting turned on)
  %li{data: {id: "tour-if-failed", button: "Next"}}
    %h3 What If It Failed?
    %p Somethings broken, now let's fix it. Send your developer a direct URL to this page, or better yet send them a link to Play Developer Mode and they can watch for themselves
  %li{data: {id: "tour-now-your-turn"}}
    %h3 Now Your Turn
    %p
      You've seen tests in action, now it's time to create one. Click here to get back to the Project Page and go ahead and
      %b create a new test.

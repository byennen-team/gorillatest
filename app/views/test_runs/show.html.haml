- content_for  :title do
  Project - #{@project.name} - #{@scenario.name} - #{@test_run.number}
- content_for :head do
  =javascript_include_tag "step_status"
  :javascript
    channels = []
    window.channels = channels
    #{
      @test_run.browser_tests.map { |test| "window.channels.push(window.pusher.subscribe('#{test.channel_name}'));"}.join(' ')
    }
    window.sec = #{@test_run.duration}
    window.completed = #{!@test_run.completed_at.nil?}

= render 'projects/projects_header'

.row
  .col-sm-3
    %h3 #{@test_run.timestamp}
  .col-sm-3
    %h3 Ran by: #{@test_run.user.name}
.row
  .col-sm-3
    Status:
    = test_run_status(@test_run)
  .col-sm-6
    .row
      .col-sm-2
        #tour-project-show-developer-mode
        = link_to developer_mode_url(@scenario), "target" => "_blank", "data-original-title" => "Move to folder", "data-placement" => "bottom", rel: "tooltip", title: "Watch Test Run Live", class: 'btn btn-default btn-sm action' do
          %i.fa.fa-video-camera
      .col-sm-2
        %button{data: {toggle: "modal", target: "#alert-dev-modal-#{@scenario.id.to_s}"}, class: "btn btn-default btn-sm action", "data-original-title" => "Move to folder", "data-placement" => "bottom", rel: "tooltip", title: "Email To Developer"}
          %i.fa.fa-paper-plane
        = render 'scenarios/email_to_developer_modal', test_id: @scenario.id.to_s, test_run: @scenario.test_runs.detect{|t| t.status == "pass" || t.status == "fail"}
%hr
.row
  .col-sm-12
    - @test_run.browser_tests.each_with_index do |test, index|
      .test
        = render partial: 'test', locals: {test: test, id: "#{index == 0 ? 'tour-test-run-page' : ''}"}


%ol.joyride-tour#test-run-tour
  %li{data: {id: "tour-test-run-page", button: "Next"}}
    %h3 Ta da!
  %li{data: {id: "tour-test-run-status", button: "Next"}}
    %h3 The Results
  %li{data: {id: "tour-recent-updates", button: "Next"}}
    %h3 Do I have to watch every time?
    %p You're here to save time, and time you will save! Once you hit run these tests are good to go. Once they're done, you'll get an update (as well as an email if you have that setting turned on)
  %li{data: {id: "tour-if-failed", button: "Next"}}
    %h3 What If It Failed?
    %p Somethings broken, now let's fix it. Send your developer a direct URL to this page, or better yet send them a link to Play Developer Mode and they can watch for themselves
  %li{data: {id: "tour-now-your-turn"}}
    %h3 Now Your Turn
    %p
      You've seen tests in action, now it's time to create one. Click here to get back to the Project Page and go ahead and
      %b create a new test.
